import{c as P,b as _,u as w,aa as R,j as e,e as C,K as T,T as A,M as Q,B as W,az as $,f as g,s as D,r as a,L as E,A as j,aA as y,D as q}from"./index-30f42a89.js";import{F as K}from"./Flex-a3f901b7.js";import{T as M}from"./TextInput-0d64c543.js";import{u as U,F as V,I as J}from"./index-572d1837.js";import{s as F}from"./sortBy-e0864bc9.js";import{T as v}from"./Tooltip-9bb34c92.js";import{I as X}from"./IconUserPlus-33f1d021.js";import{G as Y}from"./Group-b310a18c.js";import{I as Z}from"./IconTrash-29367d2b.js";import{M as ee}from"./ModalMenu-4d728021.js";import{G as L}from"./Grid-ccdb07e6.js";var se=P("crown-off","IconCrownOff",[["path",{d:"M18 18h-13l-1.865 -9.327a.25 .25 0 0 1 .4 -.244l4.465 3.571l1.6 -2.4m1.596 -2.394l.804 -1.206l4 6l4.464 -3.571a.25 .25 0 0 1 .401 .244l-1.363 6.818",key:"svg-0"}],["path",{d:"M3 3l18 18",key:"svg-1"}]]),te=P("crown","IconCrown",[["path",{d:"M12 6l4 6l5 -4l-2 10h-14l-2 -10l5 4z",key:"svg-0"}]]);const re=()=>{const d=_(),{crew:r}=w(R),o=t=>{const c={...r,photo:t};d($(c))},l=()=>{g("av_racing","updateCrew",r)};return e.jsx(e.Fragment,{children:e.jsxs(C,{style:{marginLeft:"5px"},children:[e.jsx(T,{alt:"logo",src:r.photo?r.photo:"https://i.imgur.com/p0oT829.png",w:120,h:120,radius:10,bg:"dark.9",mt:10,style:{marginLeft:"auto",marginRight:"auto"}}),e.jsxs(K,{gap:"xs",justify:"flex-start",align:"left",direction:"column",wrap:"wrap",mt:10,children:[e.jsx(A,{order:4,style:{textAlign:"center",maxWidth:"200px",marginLeft:"auto",marginRight:"auto"},truncate:!0,children:r.label}),e.jsx(M,{value:r.photo,icon:e.jsx(Q,{size:"0.95rem"}),size:"xs",onChange:t=>{o(t.target.value)},style:{marginLeft:"auto",marginRight:"auto"},disabled:!r.isBoss,w:"90%"}),e.jsx(W,{size:"xs",color:"cyan.7",style:{justifyContent:"center",width:"90%",marginLeft:"auto",marginRight:"auto"},mb:5,disabled:!r.isBoss,onClick:()=>{l()},children:"Save"})]})]})})},oe=({handleHire:d})=>{const r=_(),{lang:o}=w(D),{crew:l,crewMembers:t}=w(R),[c,p]=a.useState({height:200,size:10}),[x,b]=a.useState(!0),[u,S]=a.useState(1),[n,h]=a.useState({columnAccessor:"name",direction:"asc"}),[z,m]=a.useState(F(t,"name")),[I,O]=a.useState(""),[k]=U(I,200),G=t==null?void 0:t.slice(0,c.size),B=async(s,i)=>{const f=await g("av_racing","editMember",{member:s,rank:i});r(y(f))},H=async s=>{const i=await g("av_racing","fireMember",s);r(y(i))};return a.useEffect(()=>{(async()=>{const f=(u-1)*c.size,N=f+c.size;m(t==null?void 0:t.slice(f,N)),setTimeout(()=>{b(!1)},250)})();const i=window.innerHeight;p({...c,height:i/2})},[t]),a.useEffect(()=>{m(G.filter(({name:s})=>!(k!==""&&!`${s} `.toLowerCase().includes(k.trim().toLowerCase()))))},[k]),a.useEffect(()=>{const s=F(t,n.columnAccessor);m(n.direction==="desc"?s.reverse():s)},[n]),a.useEffect(()=>{const s=(u-1)*c.size,i=s+c.size;m(t==null?void 0:t.slice(s,i))},[u]),e.jsx(C,{mt:-1,children:x?e.jsx("div",{style:{position:"relative",width:"100%",height:"100%"},children:e.jsx(E,{visible:x,overlayBlur:2,overlayColor:"rgba(20, 21, 23, 1)"})}):e.jsx(V,{withBorder:!0,borderRadius:2,height:c.height,style:{backgroundColor:"#1A1B1E",borderColor:"rgba(255,255,255,0.13"},records:z,columns:[{accessor:"",render:s=>e.jsx(T,{src:s.photo,alt:s.name,size:50,radius:10}),title:e.jsx(e.Fragment,{children:l.isBoss?e.jsx(v,{label:o.racing.invite,color:"dark.5",children:e.jsx(j,{color:"cyan.7",variant:"filled",onClick:s=>{s.stopPropagation(),d()},children:e.jsx(X,{size:16})})}):e.jsx(e.Fragment,{})}),width:65},{accessor:"name",render:({name:s})=>`${s}`,filter:e.jsx(M,{label:o.business.search_user,description:o.business.search_user_description,placeholder:o.business.search,icon:e.jsx(J,{size:16}),value:I,onChange:s=>O(s.currentTarget.value)}),filtering:I!=="",sortable:!0},{title:o.racing.races_won,accessor:"wins",sortable:!0},{title:o.racing.total_races,accessor:"races",sortable:!0},{title:o.racing.joined,accessor:"joined",sortable:!0},{accessor:"actions",render:s=>e.jsx(e.Fragment,{children:l.isBoss?e.jsx(e.Fragment,{children:e.jsxs(Y,{spacing:4,position:"center",noWrap:!0,children:[s.isBoss?e.jsx(v,{label:o.racing.remove_boss,color:"dark.5",children:e.jsx(j,{color:"blue.2",onClick:i=>{i.stopPropagation(),B(s,0)},children:e.jsx(se,{size:16})})}):e.jsx(v,{label:o.racing.set_boss,color:"dark.5",children:e.jsx(j,{color:"blue.2",onClick:i=>{i.stopPropagation(),B(s,1)},children:e.jsx(te,{size:16})})}),e.jsx(v,{label:o.racing.remove_member,color:"dark.5",children:e.jsx(j,{color:"red.2",onClick:i=>{i.stopPropagation(),H(s)},children:e.jsx(Z,{size:16})})})]})}):null})}],sortStatus:n,onSortStatusChange:h,totalRecords:t.length,recordsPerPage:c.size,page:u,onPageChange:s=>S(s),paginationColor:"cyan.7"})})};const me=({crew:d})=>{const r=_(),{lang:o}=w(D),[l,t]=a.useState(!0),[c,p]=a.useState(!1),[x,b]=a.useState({}),u=()=>{b({title:"Invite Player",options:[{type:"number",title:"Player ID",name:"playerId"}],button:"Confirm",extraData:{event:"inviteCrew",crew:d}}),p(!0)},S=async n=>{if(p(!1),n!=null&&n.extraData){const h=await g("av_racing",n==null?void 0:n.extraData.event,n);r(y(h))}};return a.useEffect(()=>{(async()=>{const h=d.name,z=await g("av_racing","getCrew",h);r(y(z)),setTimeout(()=>{t(!1)},250)})()},[]),e.jsx(e.Fragment,{children:e.jsxs(C,{className:"racing-leaderboard-container",children:[c&&e.jsx(ee,{callback:S,data:x}),l?e.jsx("div",{style:{position:"relative",width:"100%",height:"100%"},children:e.jsx(E,{visible:l,overlayBlur:2,overlayColor:"rgba(20, 21, 23, 1)"})}):e.jsxs(e.Fragment,{children:[e.jsxs(C,{style:{textAlign:"center",marginTop:"0px"},children:[e.jsx(A,{order:2,children:o.racing.crew_header}),e.jsx(q,{mt:10})]}),e.jsxs(L,{grow:!0,gutter:"xs",children:[e.jsx(L.Col,{xs:1,xl:1,span:1,children:e.jsx(re,{})}),e.jsx(L.Col,{xs:8,xl:9,span:9,children:e.jsx(oe,{handleHire:u})})]})]})]})})};export{me as default};
