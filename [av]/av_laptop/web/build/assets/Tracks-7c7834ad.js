import{c as y,u as g,s as M,j as e,T as S,C as z,e as v,aa as I,B as X,r as h,D as A,b as K,y as Q,f as b,aN as U}from"./index-30f42a89.js";import{C as k}from"./Card-73f8d616.js";import{F as j}from"./Flex-a3f901b7.js";import{B as Y}from"./Badge-5a2eb96f.js";import{T as C}from"./Tooltip-9bb34c92.js";import{I as Z}from"./IconTrash-29367d2b.js";import{G as B}from"./GetTrackType-d081291d.js";import{I as ee}from"./IconFlame-4063da0b.js";import{S as N}from"./Select-811cb72a.js";import{T as ae}from"./TextInput-0d64c543.js";import{M as te}from"./ModalMenu-4d728021.js";import{M as m}from"./Modal-e582506a.js";import{T as re}from"./Table-02c47a96.js";import{G as se}from"./Group-b310a18c.js";var ne=y("award","IconAward",[["path",{d:"M12 9m-6 0a6 6 0 1 0 12 0a6 6 0 1 0 -12 0",key:"svg-0"}],["path",{d:"M12 15l3.4 5.89l1.598 -3.233l3.598 .232l-3.4 -5.889",key:"svg-1"}],["path",{d:"M6.802 12l-3.4 5.89l3.598 -.233l1.598 3.232l3.4 -5.889",key:"svg-2"}]]),le=y("calendar-event","IconCalendarEvent",[["path",{d:"M4 5m0 2a2 2 0 0 1 2 -2h12a2 2 0 0 1 2 2v12a2 2 0 0 1 -2 2h-12a2 2 0 0 1 -2 -2z",key:"svg-0"}],["path",{d:"M16 3l0 4",key:"svg-1"}],["path",{d:"M8 3l0 4",key:"svg-2"}],["path",{d:"M4 11l16 0",key:"svg-3"}],["path",{d:"M8 15h2v2h-2z",key:"svg-4"}]]),ie=y("map-search","IconMapSearch",[["path",{d:"M11 18l-2 -1l-6 3v-13l6 -3l6 3l6 -3v8",key:"svg-0"}],["path",{d:"M9 4v13",key:"svg-1"}],["path",{d:"M15 7v5",key:"svg-2"}],["path",{d:"M18 18m-3 0a3 3 0 1 0 6 0a3 3 0 1 0 -6 0",key:"svg-3"}],["path",{d:"M20.2 20.2l1.8 1.8",key:"svg-4"}]]),ce=y("road","IconRoad",[["path",{d:"M4 19l4 -14",key:"svg-0"}],["path",{d:"M16 5l4 14",key:"svg-1"}],["path",{d:"M12 8v-2",key:"svg-2"}],["path",{d:"M12 13v-2",key:"svg-3"}],["path",{d:"M12 18v-2",key:"svg-4"}]]),oe=y("search","IconSearch",[["path",{d:"M10 10m-7 0a7 7 0 1 0 14 0a7 7 0 1 0 -14 0",key:"svg-0"}],["path",{d:"M21 21l-6 -6",key:"svg-1"}]]);const de=({track:r,serial:c,deleteRace:s,handlePreview:n,createEvent:l,createRace:u,handleDelete:d,handleLeaderboard:x})=>{const{lang:a}=g(M);return e.jsxs(k,{padding:"10px",radius:"sm",withBorder:!0,className:"track-card",children:[e.jsx(k.Section,{style:{display:"flex",marginTop:"-3px",marginLeft:"1px"},children:e.jsxs(j,{gap:"md",justify:"center",align:"center",direction:"row",wrap:"wrap",children:[e.jsx(S,{order:4,weight:500,truncate:!0,w:150,style:{maxWidth:"100%",overflow:"hidden",whiteSpace:"nowrap",textOverflow:"ellipsis"},color:"gray.3",children:r.name}),e.jsx(Y,{color:r.color?`${r.color}`:"blue.2",children:r.type?e.jsx(e.Fragment,{children:r.type}):e.jsx(e.Fragment,{children:a.racing.default_type})})]})}),e.jsx(k.Section,{maw:"100%",mah:80,style:{overflow:"auto",marginLeft:"1px"},children:e.jsx(z,{size:12,mt:3,children:r.description})}),e.jsxs(k.Section,{style:{display:"inline-flex",position:"absolute",bottom:"0",padding:"10px",justifyContent:"space-between",width:"100%",marginBottom:"-8px"},children:[e.jsx(v,{style:{display:"flex",margin:"auto",marginLeft:"0"},children:e.jsxs(j,{gap:"0px",justify:"flex-start",align:"center",direction:"row",wrap:"wrap",children:[e.jsx(ce,{size:16}),e.jsx(z,{size:12,ml:3,italic:!0,children:`${r.distance} ${a.racing.distance_unit}`})]})}),e.jsx(v,{children:e.jsxs(j,{gap:"5px",justify:"flex-start",align:"center",direction:"row",wrap:"wrap",children:[e.jsx(C,{label:a.racing.preview,color:"cyan.7",withArrow:!0,children:e.jsx(ie,{size:16,style:{marginRight:"3px"},className:"track-icon",onClick:()=>{n(r.checkpoints)}})}),u&&e.jsx(C,{label:a.racing.create_event,color:"cyan.7",withArrow:!0,children:e.jsx(le,{size:16,className:"track-icon",onClick:()=>{l(r)}})}),e.jsx(C,{label:a.racing.leaderboard_tab,color:"cyan.7",withArrow:!0,children:e.jsx(ne,{size:16,className:"track-icon",onClick:()=>{x(r)}})}),c==r.createdby||s?e.jsx(e.Fragment,{children:e.jsx(C,{label:a.racing.delete_track,color:"cyan.7",withArrow:!0,children:e.jsx(Z,{size:16,className:"track-icon",onDoubleClick:()=>{d(r.identifier)}})})}):null]})})]})]})},pe=(r,c)=>{let s=0;return r.map(n=>B(n.type,c)?s+=1:null),s},he=({handleSearch:r,handleFilter:c,handleNew:s})=>{const{lang:n}=g(M),{filterCategories:l,trackList:u,circuitPermission:d}=g(I),x=pe(u,l);return e.jsxs(v,{className:"tracks-header",children:[e.jsxs(j,{justify:"flex-start",align:"center",direction:"row",wrap:"wrap",children:[e.jsx(ee,{size:23,color:"#3BC9DB",style:{marginTop:"2.5px"}}),e.jsx(S,{color:"gray.4",order:2,ml:5,children:`${x} ${n.racing.tracks}`})]}),e.jsxs(j,{justify:"flex-start",align:"center",direction:"row",wrap:"wrap",gap:"xs",children:[d&&e.jsx(X,{color:"cyan",size:"xs",onClick:()=>{s()},children:n.racing.new_track}),e.jsx(N,{defaultValue:"all",data:l,onChange:a=>{c(a)},withinPortal:!0,size:"sm",w:120}),e.jsx(ae,{placeholder:n.racing.search,icon:e.jsx(oe,{size:"0.8rem"}),onChange:a=>r(a.currentTarget.value),size:"sm",w:200})]})]})},ue=({data:r,setShowLeaderboard:c})=>{const{lang:s}=g(M),[n,l]=h.useState([]),[u,d]=h.useState([]),x=a=>{const o=r.filter(f=>f.class.toLowerCase().includes(a));l(o)};return h.useEffect(()=>{const a=n==null?void 0:n.map(o=>e.jsxs("tr",{children:[e.jsx("td",{children:o.name}),e.jsx("td",{children:o.vehicle}),e.jsx("td",{children:o.bestTime}),e.jsx("td",{children:o.crew})]},o.name));d(a)},[n]),e.jsx("div",{className:"track-leaderboard",children:e.jsxs(m.Root,{opened:!0,onClose:()=>{c(!1)},target:".app-content",size:"lg",radius:5,children:[e.jsx(m.Overlay,{}),e.jsxs(m.Content,{children:[e.jsxs(m.Header,{children:[e.jsx(S,{order:4,style:{width:"100%",textAlign:"center"},children:s.racing.best_times}),e.jsx(m.CloseButton,{})]}),e.jsx(A,{}),e.jsxs(m.Body,{children:[e.jsx(v,{mt:5,children:e.jsx(N,{label:s.racing.vehicle_class,data:[{value:"m",label:"M"},{value:"d",label:"D"},{value:"c",label:"C"},{value:"b",label:"B"},{value:"a",label:"A"},{value:"a+",label:"A+"},{value:"s",label:"S"},{value:"s+",label:"S+"}],onChange:x,withinPortal:!0,size:"xs"})}),e.jsx(v,{children:e.jsxs(re,{children:[e.jsx("thead",{children:e.jsxs("tr",{children:[e.jsx("th",{children:s.racing.username}),e.jsx("th",{children:s.racing.vehicle}),e.jsx("th",{children:s.racing.best_lap}),e.jsx("th",{children:s.racing.crew})]})}),e.jsx("tbody",{children:u})]})})]})]})]})})};const Te=()=>{const r=K(),{serial:c}=g(Q),{deleteRace:s,createRace:n,trackList:l,filterCategories:u,tracksCategories:d,settings:x}=g(I),{lang:a}=g(M),[o,f]=h.useState(l),[D,_]=h.useState(!1),[R,T]=h.useState({}),[F,L]=h.useState(!1),[G,E]=h.useState({}),O=t=>{const p=l.filter(i=>t==""?l:i.name.toLowerCase().includes(t.toLowerCase()));f(p)},$=t=>{const p=l.filter(i=>{var w;return t=="all"?l:(w=i==null?void 0:i.type)==null?void 0:w.toLowerCase().includes(t.toLowerCase())});f(p)},P=t=>{b("av_racing","preview",{checkpoints:t,settings:x})},q=t=>{T({title:a.racing.create_event_title,options:[{name:"title",icon:"fa-solid fa-file-lines",title:a.racing.event_name,type:"text",asterisk:!0},{name:"password",icon:"fa-solid fa-key",title:a.racing.event_password,type:"password"},{name:"startsin",icon:"fa-regular fa-clock",title:a.racing.event_startsin,type:"number",asterisk:!0},{name:"buyin",icon:"fa-solid fa-sack-dollar",title:a.racing.event_buyin,type:"number",asterisk:!0},{name:"laps",icon:"fa-solid fa-flag-checkered",title:a.racing.event_laps,type:"number",default:0,asterisk:!0},{name:"class",title:a.racing.event_class,type:"select",asterisk:!0,max:1,searchable:!1,options:[{value:"all",label:"All"},{value:"m",label:"M"},{value:"d",label:"D"},{value:"c",label:"C"},{value:"b",label:"B"},{value:"a",label:"A"},{value:"a+",label:"A+"},{value:"s",label:"S"},{value:"s+",label:"S+"}]},{name:"type",title:a.racing.event_type,type:"select",asterisk:!0,searchable:!0,options:d},{name:"description",icon:"fa-regular fa-pen-to-square",label:a.racing.event_description,type:"textarea",asterisk:!1}],button:"Confirm",extraData:{event:"newRace",track:t}}),_(!0)},H=()=>{T({title:a.racing.create_track,options:[{name:"title",icon:"fa-solid fa-file-lines",title:a.racing.track_name,type:"text",asterisk:!0},{name:"type",title:a.racing.track_type,type:"select",asterisk:!0,searchable:!0,options:d},{name:"description",icon:"fa-regular fa-pen-to-square",label:a.racing.track_description,type:"textarea",asterisk:!0}],button:a.racing.confirm_button,extraData:{event:"createTrack"}}),_(!0)},J=async t=>{_(!1),t&&b("av_racing",t.extraData.event,t)},V=t=>{if(l.find(i=>i.identifier===t)){const i=l.filter(w=>w.identifier!==t);r(U(i)),f(i),b("av_racing","deleteTrack",t)}},W=t=>{if(t.leaderboard){const p=JSON.parse(t.leaderboard);E(p),L(!0)}else b("av_racing","noRecords")};return e.jsxs(v,{className:"tracks-container",children:[D&&e.jsx(te,{callback:J,data:R}),F&&e.jsx(ue,{data:G,setShowLeaderboard:L}),e.jsx(he,{handleSearch:O,handleFilter:$,handleNew:H}),e.jsx(A,{mt:10}),e.jsx(se,{grow:!0,mt:10,style:{overflow:"auto",overflowX:"hidden"},className:"track-reactive",children:o.map((t,p)=>e.jsx(e.Fragment,{children:B(t.type,u)?e.jsx(e.Fragment,{children:e.jsx(de,{track:t,lang:a,serial:c,deleteRace:s,handleDelete:V,createRace:n,handlePreview:P,createEvent:q,handleLeaderboard:W},p)}):e.jsx(e.Fragment,{})}))})]})};export{Te as default};
